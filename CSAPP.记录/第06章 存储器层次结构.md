# 重点

- SRAM（用作高速缓存）肯定比DRAM（内存）快

- SRAM，双稳态（类似三角形上放一个钟摆，自己感受），理论上有亚稳态但是在最细微的扰动下也会陷入其中一种稳态；即使有干扰，在干扰消失后也会恢复到稳定值；（仍然掉电会消失）

- DRAM，非常密集，每个位由一个电容和一个晶体管组成，对干扰非常敏感，甚至暴露在光线下也会导致电容电压改变（数码照相机里面也是DRAM）

  DRAM会漏电，必须周期性读出数据再重新写来刷新每一位。（有些系统也用纠错码，其中计算机的字会被多编码几个位）

- SRAM比DRAM每位用的晶体管更多，因此更稀疏；（6：1）

- DRAM的基本单位是超单元(supercell)，每个超单元都是由w个基本单元（位）组成，而DRAM实际就是个由超单元组成的矩阵而已。

  DRAM的地址线，先传要访问的超单元的行地址RAS，再传要访问的超单元的列地址CAS；

  DRAM中有个行缓冲区，在首先接收到RAS的时候就会把一行读到行缓冲区中，然后CAS一来就可以把对应w位的超单元输出出来；

- 几款增强型DRAM（了解）：

  - 快页模式DRAM（FPM DRAM）：就是说要读取同一行的不同列的超单元，只需要发一次RAS，然后后面发几个CAS就拿几个超单元。（减少了发送RAS的次数）

  - 扩展数据输出DRAM（EDO DRAM）：FPM DRAM的增强型，就是说多个CAS可以发得更紧密一点。

  - 同步DRAM（SDRAM）：大概意思是说SDRAM利用了来自主机的时钟信号，因此和主机联系更加同步，加快了读取速度；

  - 双倍数据速率同步DRAM（DDR SDRAM）：书上说用了两个时钟沿作为控制信号，然后速度就翻倍了。。。

  - 视频RAM（VRAM）：

    VRAM接收控制信号的方式和FPM DRAM差不多，但VRAM的输出是通过依次对**VRAM内部缓冲区**的整个内容进行移位得到的；

    VRAM允许对内存同时读和写。



- 几种ROM：
  - PROM（电丝焊接）：只能被编程一次；
  - EPROM（紫外线擦除为0，在特定设备上写1，只可写1000次）
  - EEPROM（电可擦除，不需要特定设备，可写10^5次）
  - Flash（基于EEPROM，PS：SSD基于闪存）
- 固件：烧录在ROM中的程序；

- CPU中有总线接口，外面有IO桥，主存；总线接口和IO桥之间是系统总线，IO桥和主存之间的是内存总线；IO桥还连接着IO总线，IO设备可以通过IO总线给CPU或主存发送数据；
- 磁盘容量：
  - 记录密度：磁道一英寸的段中可以放入的位数；
  - 磁道密度：从盘片中心出发半径上一英寸的段内可以有的磁道数；
  - 面密度：记录密度 x 磁道密度；
- 一般一个磁道的扇区数量是由最里面的磁道决定的，但是当半径太大时最外面的磁道的数据密度就会变得很低，因此后面又有了*多区记录*的叫法，即将半径上不同区间的柱面分区，每个区内的柱面的一个磁道的扇区数相同，而不同区的磁道的扇区数不同；
- 对于DRAM和SRAM容量相关的计量单位K=2^10，而对于磁盘和网络这种IO设备容量相关的计量单位，通常K=10^3；
- 对扇区的访问时间 = 寻道时间 + 旋转时间 + 传送时间；
- 在现代操作系统的眼中，一个磁盘就是一个B个扇区大小的**逻辑块**的序列，磁盘封装中有一个小的硬件/固件设备，称为磁盘控制器，维护着逻辑块号和**实际物理扇区**之间的映射关系；
- 磁盘格式化就是：标识扇区的信息填写扇区之间的间隙，标识出表面有故障的柱面并且不使用它们，以及在每个区中预留出一组柱面作为备用。（如果区中一个或多个柱面在磁盘使用过程中坏掉了，就可以使用这些备用的柱面）
- 内存映射IO：
  - IO端口：地址空间有一块地址是为与IO设备通信保留的，每个这样的地址称为IO端口；
  - 当一个设备连接到总线时，它与一个或多个端口相关联；
  - 例如设备A的端口0xa0，则0xa0的地址就相当于是一个接收命令的端口，cpu可以往0xa0发送相应的磁盘控制命令；



- 固态硬盘SSD：
  - SSD由多个闪存芯片和一个闪存翻译层组成，闪存芯片替代传统旋转磁盘中的机械驱动器，闪存翻译层就类似磁盘控制器（负责将逻辑块的请求翻译成对底层物理设备的访问）
  - 读SSD比写SSD快；
  - 一个闪存由多个块组成，每个块由多个页组成，读写以**页**为单位！只有在一页所属的块被擦除之后，才能写这一页。（擦除以块为单位）
  - SSD随机写的代价很高！因为如果你要在已有数据的页上进行修改，则SSD的做法是把这个块的所有带数据的页复制到一个新块才能进行对页p的写。
- 强制不命中：就是指Cache刚启动为空的时候必定会不命中的那几次；
- 容量不命中：缓存太小，访问的工作集太大导致的不命中；
- Cache抖动：高速缓存反复地加载和驱逐相同的高速缓存块的组；



- 存储器层次结构越往下走，远离CPU，一次不命中的开销就会更加昂贵，用更好的替换策略使得不命中最少也变得更加值得；
- 一般的TLB(Translation Look-aside Buffer)其实就是全相联的Cache；



- Cache写：

  - 写命中：写回法、写直达法；
  - 写不命中：写分配法（写了后要加载到缓存中），非写分配法（写了后也不加载到缓存中）
  - 写回法一般和写分配法一起用；写直达法一般和非写分配法一起用；

- 作者推荐写回法+写分配法，说这是大势所趋；

- 相联度大，则命中速度大且不命中速度也变大（因为一些机制例如LRU更复杂了），而相联度小则不命中概率变大；

  一般来说，靠近CPU的cache的因为处罚小，则一般相联度较小，而远离CPU的Cache（靠近磁盘）则一次不命中的处罚就很大，因此相联度一般很大（保证命中率较大）；

- 一般来说，高速缓存越往下层，越可能使用写回而不是直写；

