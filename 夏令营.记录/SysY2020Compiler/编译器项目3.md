| 语法                  | 描述                                   |
| --------------------- | -------------------------------------- |
| LABEL x :             | 定义标号x。                            |
| FUNCTION f :          | 定义函数f。                            |
| x := y                | 赋值操作。                             |
| x := y + z            | 加法操作。                             |
| x := y - z            | 减法操作。                             |
| x := y * z            | 乘法操作。                             |
| x := y / z            | 除法操作。                             |
| x := &y               | 取y的地址赋给x。                       |
| x := *y               | 取以y值为地址的内存单元的内容赋给x。   |
| *x := y               | 取y值赋给以x值为地址的内存单元。       |
| GOTO x                | 无条件跳转至标号x。                    |
| IF x [relop] y GOTO z | 如果x与y满足[relop]关系则跳转至标号z。 |
| RETURN x              | 退出当前函数并返回x值。                |
| DEC x [size]          | 内存空间申请，大小为4的倍数。          |
| ARG x                 | 传实参x。                              |
| x := CALL f           | 调用函数，并将其返回值赋给x。          |
| PARAM x               | 函数参数声明。                         |
| READ x                | 从控制台读取x的值。                    |
| WRITE x               | 向控制台打印x的值。                    |

- 中间代码不存在作用域的概念，因此不同的变量一定要避免重名；
- ARG传入参数的顺序和PARAM声明参数的顺序正好相反；
- 函数参数是结构体时，传的也是地址；



中间代码的设计更多的是一门艺术而不是技术。



中间代码可分为如下三类：

- **高层次中间代码**：这种中间代码体现了较高层次的细节信息，因此和高级语言类似，保留了不少包括数组、循环在内的源语言的特征。

  高层次中间代码常被用于进行相关性分析和解释执行。Java bytecode和Python .pyc文件都是高层次IR；

- **中层次中间代码**：既体现了许多高级语言的一般特性，又可以被方便地转换为低级语言的代码。

  中层次中间代码可以进行绝大部分优化处理，例如公共子表达式消除、代码移动、代数运算简化。

- **低层次中间代码**：低层次中间代码与目标代码非常接近，在变量的基础上可能会加入寄存器的细节信息。



中间代码还可分为如下三类：

- 图形中间代码：以结点、边元素来组织代码信息，例如抽象语法树；
- 线形中间代码：一般的中间代码就是这样；
- 混合型中间代码：结合前两者，例如可以将中间代码组织成许多基本块，块内部用线形表示，块与块之间用图表示。



### 翻译模式

为每个主要的语法单元X都设置相应的翻译函数translate_X.

- 翻译Exp

![image-20210614002631643](.\images\image1.png)

- 翻译条件跳转

![image-20210614003033532](.\images\image2.png)