# 泛型

- 泛型——初认识

  ```rust
  struct A<T>{
      A1:T,
  }
  
  let a_int = A::<i32>{A1:123};
  let a_bool = A::<bool>{A1:true};
  // Rust可以推断出泛型的类型
  let a_float = A{A1:3.14};
  ```

- 空

  ```rust
  // 在Rust中怕出现空指针导致崩溃的情况，因此没有null关键字
  // 那么如何表示一个空的属性呢（有时候空的存在是必要的），则可以像如下表示一个属性为空
  enum Attr{
      AttrReal(String),
      None
  }
  
  struct Test{
      attr:Attr,
  }
  ```

  

- Option

  ```rust
  // 为了安全地表示空值，Rust内置有泛型Enum，Option，其作用就和上面的Enum Attr一样
  enum Option<T>{
      None,
      Some(T),
  }
  
  struct ClassA<T>{
      item: Option<T>,
  }
  
  let test_a = ClassA::<i32> {item:None};
  
  // 判断是否是None
  if test_a.item.is_none(){
      ;
  }
  
  let test_b = ClassA::<i32> {item:Some(123)};
  
  // 判断是否是some
  if test_b.item.is_some(){
      ;
  }
  
  // 解构Option
  match test_b.item{
      Some(v) => {
          ;	//在这里v就是一个i32整型
      }
      None => {;},
  }
  ```

- Result

  ```rust
  // Rust内置的又一个枚举，可以让我们返回一个可能包含错误的值
  enum Result<T,E>{
      Ok(T),
      Err(E),
  }
  
  // 构建Result
  fn func(i:i32) -> Result<i32, String> {
      if i<100 {
          520
      }else{
          String::from("Hello")
      }
  }
  
  let result = func(99);
  match result{
      Ok(v) => {
          ;	// 这里v就是i32类型
      }
      Err(e) => {
          ;	// 这里e就是String类型
      }
  }
  ```

- main函数返回Result

  ```rust
  // 背景知识：
  // main函数可以return Err(String); 这样会自动被Rust打印出Error信息
  // main函数不返回值, 不是None只能是()
  fn main() -> Result<(), String> {
      if 1 == 2 {
          return Err(String::from("123123"));
      }
      // 用()括号且不带分号来表示返回个Ok的空值
      Ok(())
  }
  ```

- 优雅地错误处理

  ```rust
  fn do_something_that_might_fail() -> Result<i32, String>{
      if 1==2 {
          520
      } else {
          Err(String::from("Hello"))
      }
  }
  // PS：普通函数也可以return 值，return语句加不加分号都无所谓
  
  // 优雅地处理就是加个?问号
  // 此时如果函数返回的是Err类型，则main函数会直接return Err, 否则会自动解构Ok(v)中的v
  fn main() -> Result<(), String> {
      let v = do_some_thing_that_might_fail()?;
      Ok(())
  }
  ```

- 粗暴的错误处理

  ```rust
  // 粗暴的错误处理就是对Option或者Result等进行直接地.unwarp()
  // 如果返回的是Ok(v)，则可以直接拿到v
  // 否则会报错panic!(工程中肯定不这么用，还是手写match来分别处理吧)
  ```

- Vectors

  ```rust
  // 背景知识：
  // Vec是一个结构体，内部保存了在堆上固定长度数据的引用
  // 一个vector开始有默认大小容器，当更多元素被添加进来后，它会重新在堆上分配一个新的并具有更大容量的定长列表
  
  // Vec创建的三种方式：
  // 1.最麻烦的一种
  let mut i32_vec = Vec::<i32>::new();
  i32_vec.push(1);
  
  // 2.不用写类型的一种
  let mut i32_vec = Vec::new();
  i32_vec.push(1);
  
  // 3.非常简单的一种
  let mut i32_vec = vec![1,2,3];
  i32_vec.push(4);
  
  //遍历vec
  for x in i32_vec.iter(){
      println!("{}",x);
  }
  ```

  

