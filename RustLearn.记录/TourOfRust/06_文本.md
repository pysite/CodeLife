# 文本

- 字符串常量

  字符串常量的类型是``&'static str``

  str表示该变量总是指向一串合法的**utf-8**字节序列

  ```rust
  fn main(){
      let a:&'static str = "Hello";	
      // 实际测试表明这里不加'static也可以，因此可以说明这个'static可能不写也能被编译器推断出来
      println!("{}", a);
  }
  ```

- utf-8

  Rust使用utf-8，用1-4字节表示1个字符，这就代表例如my_text[3]这种不能像传统ASCII编码标准那么快，因为前面的字符具有不同的长度，必须查找相关字符长度才知道下标3的字符的位置。

- 转义字符

  Rust中也有C语言中那样的转义字符

  ```rust
  \n 	换行
  \r 	回车
  \t	制表符
  \\	代表单个反斜杠
  \0	空字符
  \' 	代表单引号
  ```

- 多行字符串常量

  使用 `\` 可以使多行字符串不换行。

  ```rust
  let a:&str ="
  	你好
  	我好
  ";
  // 如果你好后面加上 \ 则'你好','我好'会在同一行
  ```

- 原始字符串常量

  用 `r#"` 开头，以 `"#` 结尾的字符串就是原始的(raw)，不会考虑转义字符。

- 文本中的字符串常量

  如果你需要使用大量文本，可以使用宏``include_str!``来从本地文件中导入文本到程序中。

  ```rust
  let hello_html = include_str!("hello.html");
  ```

- 字符串片段Slice

  Rust不接受无效unicode字符构成的片段

  ```rust
  let a = "这是一句中文句子";
  let first_a = &a[0..6];
  let last_a = &a[7..11];
  ```

- Char

  为了解决使用 Unicode 带来的麻烦，Rust 提供了将 utf-8 字节序列转化为类型 `char` 的 vector 的方法。

  每个 `char` 长度都为 4 字节（可提高字符查找的效率）。

  ```rust
  // 收集字符并转换为char的vector
  let chars = "你好你好".chars().collect::<Vec<char>>();
  // 由于char为4字节长，可以转化为u32
  println!("{}", chars[3] as u32);
  ```

- String

  **字符串`String`** 是一个结构体，其持有以堆（heap）的形式在内存中存储的 utf-8 字节序列。

  由于它以堆的形式来存储，字符串可以延长、修改等等。这些都是字符串常量（string literals）无法执行的操作。

  常用方法：

  - `push_str` 用于在字符串的结尾添加字符串常量（&str）。
  - `replace` 用于将一段字符串替换为其它的。
  - `to_lowercase`/`to_uppercase` 用于大小写转换。
  - `trim` 用于去除字符串前后的空格。

  如果字符串`String` 被释放（drop）了，其对应的堆内存片段也将被释放。

  字符串`String` 可以使用 `+` 运算符来在其结尾处连接一个 `&str` 并将其自身返回。但这个方法可能并不像你想象中的那么人性化。

  ```rust
  fn main() {
      let mut helloworld = String::from("你好");
      helloworld.push_str(" 世界");
      helloworld = helloworld + "!";
      println!("{}", helloworld);
  }
  ```

- 文本作为函数参数

  一般以``&str``的形式作为参数

  ```rust
  fn say_it_loud(msg:&str){
      println!("{}！！！",msg.to_string().to_uppercase());
  }
  
  fn main() {
      // say_it_loud can borrow &'static str as a &str
      say_it_loud("Hello");
      // say_it_loud can also borrow String as a &str
      say_it_loud(&String::from("GoodBye"));
  }
  ```

- 字符串构建

  concat是拼接；join是用某个符号连接起来；

  ```rust
  let helloworld = ["a", "b", "c"].concat();	//abc
  let abc = ["a", "b", "c"].join(",");	// a,b,c
  ```

- 字符串格式化

  宏 `format!` 可用于创建一个使用占位符的参数化字符串。（例：`{}`）

  `format!` 和 `println!` 生成的参数化字符串相同，只是 `format!` 将其返回而 `println!` 将其打印出来

  ```rust
  let a = 42;
  let f = format!("生活诀窍: {}",a);
  println!("{}",f);
  ```

- 字符串转换

  to_string将str变为String；

  parse可将字符串进行某种解析，例如"123"变为整型123；parse会抛出Err，因此要注意使用parse的函数要返回Result。

  ```rust
  fn main()->Result<(), std::num::ParseIntError>{
      let a = 42;
      let a_string = a.to_string();
      let b = a_string.parse::<i32>()?;
      Ok(());
  }
  ```

  

